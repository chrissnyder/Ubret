// Generated by CoffeeScript 1.3.3
(function() {
  var BaseTool, SubjectViewer,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  try {
    BaseTool = require('./base_tool');
  } catch (error) {
    BaseTool = window.Ubret.BaseTool;
  }

  SubjectViewer = (function(_super) {

    __extends(SubjectViewer, _super);

    SubjectViewer.prototype.template = "<% if(subject.image) { %>\n  <img src=\"<%- subject.image %>\" />\n<% } %>\n\n<ul>\n  <% for(i = 0; i < keys.length; i++) { %>\n    <li>\n      <%- keys[i] %>: <%- subject[keys[i]] %>\n    </li>\n  <% } %>\n</ul>";

    function SubjectViewer(opts) {
      this.nextSubject = __bind(this.nextSubject, this);

      this.prevSubject = __bind(this.prevSubject, this);

      this.render = __bind(this.render, this);

      this.start = __bind(this.start, this);
      SubjectViewer.__super__.constructor.apply(this, arguments);
      this.count = 0;
      this.start();
    }

    SubjectViewer.prototype.start = function() {
      var datum, i, _i, _len, _ref;
      if (this.selectedElement) {
        _ref = this.data;
        for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {
          datum = _ref[i];
          if (this.selectedElement === datum.id) {
            this.count = i;
          }
        }
      }
      return this.render();
    };

    SubjectViewer.prototype.render = function() {
      var compiled;
      compiled = _.template(this.template, {
        subject: this.data[this.count],
        keys: this.keys
      });
      return this.el.html(compiled);
    };

    SubjectViewer.prototype.prevSubject = function() {
      this.count -= 1;
      if (this.count < 0) {
        this.count = this.data.length - 1;
      }
      return this.selectElementCb(this.data[this.count].id);
    };

    SubjectViewer.prototype.nextSubject = function() {
      this.count += 1;
      if (this.count >= this.data.length) {
        this.count = 0;
      }
      return this.selectElementCb(this.data[this.count].id);
    };

    return SubjectViewer;

  })(BaseTool);

  if (typeof require === 'function' && typeof module === 'object' && typeof exports === 'object') {
    module.exports = SubjectViewer;
  } else {
    window.Ubret['SubjectViewer'] = SubjectViewer;
  }

}).call(this);
